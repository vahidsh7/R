---
type SkeletonVariant = 'image' | 'title' | 'text' | 'line';

interface Props {
  variant?: SkeletonVariant;
  width?: string;
  height?: string;
  class?: string;
  rounded?: boolean;
}

const {
  variant = 'text',
  width,
  height,
  class: className = '',
  rounded = true,
} = Astro.props as Props;

const variantClasses = {
  image: 'h-48 w-full',
  title: 'h-6 w-3/4',
  text: 'h-4 w-full',
  line: 'h-4 w-full',
};

const baseClass = variantClasses[variant];
const roundedClass = rounded ? 'rounded-lg' : '';
---

<div
  class={`skeleton-shimmer ${baseClass} ${roundedClass} ${className}`.trim()}
  style={width || height
    ? `${width ? `width: ${width};` : ''}${height ? `height: ${height};` : ''}`
    : undefined}
  aria-hidden="true"
>
</div>

<style>
  .skeleton-shimmer {
    background: linear-gradient(
      90deg,
      #f0f0f0 0%,
      #f0f0f0 40%,
      #e8e8e8 50%,
      #f0f0f0 60%,
      #f0f0f0 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s ease-in-out infinite;
  }

  :global(.dark) .skeleton-shimmer {
    background: linear-gradient(
      90deg,
      #2a2a2a 0%,
      #2a2a2a 40%,
      #333333 50%,
      #2a2a2a 60%,
      #2a2a2a 100%
    );
    background-size: 200% 100%;
  }

  @keyframes shimmer {
    0% {
      background-position: 200% 0;
    }
    100% {
      background-position: -200% 0;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .skeleton-shimmer {
      animation: none;
      background: #f0f0f0;
    }

    :global(.dark) .skeleton-shimmer {
      background: #2a2a2a;
    }
  }
</style>
